{% extends "layout/page.html" %}

{% block css %}
<style>
    .cart-container {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
    }
    .cart-items {
        width: 70%;
    }
    .checkout-section {
        width: 25%;
        border: 1px solid #ccc;
        padding: 20px;
        border-radius: 8px;
        background-color: #f9f9f9;
    }
    .category-image {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 8px;
    }
    .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding: 10px;
        border-bottom: 1px solid #ccc;
    }
    .cart-item-details {
        display: flex;
        align-items: center;
    }
    .cart-item-details img {
        margin-right: 20px;
    }
    .cart-item-actions {
        display: flex;
        align-items: center;
    }
    .cart-item-actions form {
        margin-left: 10px;
    }
</style>
{% endblock %}

{% block sidebar %}
{% include "layout/sidebar.html" %}
{% endblock %}

{% block content %}
<div id="wrapper">
    <section id="two" class="wrapper style3 fade-up">
        <h2>Your Shopping Cart</h2>
        {% if cart.items %}
        <div class="cart-container">
            <div class="cart-items">
                {% for item in cart.items %}
                <div class="cart-item">
                    <div class="cart-item-details">
                        <img src="{{ item.product.display_image_url if item.product.display_image_url else '/static/images/default_product.png' }}" class="category-image" alt="{{ item.name }}">
                        <span>{{ item.name|title }}</span> (Quantity: {{ item.quantity }})
                    </div>
                    <div class="cart-item-actions">
                        <span>Price: {{ item.line_price | currency }}</span>
                        <form action="{{ url_for('cart.update_quantity', product_id=item.product_id) }}" method="post" style="display: inline;">
                            <input type="number" name="quantity" value="{{ item.quantity }}" min="1">
                            <button type="submit">Update</button>
                        </form>
                        <form action="{{ url_for('cart.remove_from_cart', product_id=item.product_id) }}" method="post" style="display: inline;">
                            <button type="submit">Remove</button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="checkout-section">
                <h3>Order Summary</h3>
                <p>Total Items: {{ cart.total_items }}</p>
                <p>Total Price: {{ cart.total_price | currency }}</p>
                <a href="{{ url_for('cart.checkout') }}" class="button">Proceed to Checkout</a>
            </div>
        </div>
        {% else %}
        <p>Your cart is empty!</p>
        {% endif %}
    </section>
</div>
{% endblock %}
