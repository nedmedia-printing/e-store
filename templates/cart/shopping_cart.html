{% extends "layout/page.html" %}

{% block css %}
<style>
    .category-image {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 8px;
    }
    .quantity-input {
        width: 50px;
    }
</style>
{% endblock %}

{% block sidebar %}
{% include "layout/sidebar.html" %}
{% endblock %}

{% block content %}
<div id="wrapper">
    <section id="two" class="wrapper style3 fade-up">
        <h2>Your Shopping Cart</h2>
        {% if cart.items %}
        <div class="cart-container">
            <div class="cart-items">
                <table class="users-table table">
                    <thead>
                        <tr class="title">
                            <th>Product Image</th>
                            <th>Product Name</th>
                            <th>Quantity</th>
                            <th>Item Price</th>
                            <th>Line Price</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in cart.items %}
                            <tr class="cart-item">
                                <td><img src="{{ item.product.display_image_url if item.product.display_image_url else '/static/images/default_product.png' }}" class="category-image" alt="{{ item.name }}"></td>
                                <td>{{ item.name|title }}</td>
                                <td>
                                    <form action="{{ url_for('cart.update_quantity', product_id=item.product_id) }}" method="post">
                                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="form-input">
                                        <button type="submit">Update</button>
                                    </form>
                                </td>
                                <td>{{ item.item_price | currency }}</td>
                                <td>{{ item.line_price | currency }}</td>
                                <td>
                                    <form action="{{ url_for('cart.remove_from_cart', item_id=item.item_id) }}" method="post" style="display: inline;">
                                        <button type="submit">Remove</button>
                                    </form>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="checkout-section">
                <h3>Order Summary</h3>
                <p>Total Items: {{ cart.total_items }}</p>
                <p>Total Price: {{ cart.total_price | currency }}</p>
                <a href="{{ url_for('cart.checkout') }}" class="button">Proceed to Checkout</a>
                <div class="card-body">
                    Note that content art and etc can be included as part of the order in the admin section
                    so once you are done placing this order you will get a chance to include your
                    Business and or Personal details.
                </div>
            </div>
        </div>
        {% else %}
        <p>Your cart is empty!</p>
        {% endif %}
    </section>
</div>
{% endblock %}
